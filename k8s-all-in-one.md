# Sonic Cloud Platform - Kubernetes All-in-One Deployment
# Sonic äº‘çœŸæœºå¹³å° - Kubernetes ä¸€ä½“åŒ–éƒ¨ç½²

## ğŸ“‹ æ¦‚è¿° / Overview

æœ¬é…ç½®æä¾›äº† Sonic äº‘çœŸæœºå¹³å°åœ¨ Kubernetes ç¯å¢ƒä¸‹çš„å®Œæ•´éƒ¨ç½²æ–¹æ¡ˆï¼Œé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼ŒåŒ…å«æœåŠ¡æ³¨å†Œä¸­å¿ƒã€API ç½‘å…³ã€æ ¸å¿ƒæ§åˆ¶å™¨ã€æ–‡ä»¶æœåŠ¡å’Œ Web å‰ç«¯ã€‚

This configuration provides a complete deployment solution for Sonic Cloud Platform in Kubernetes environment, using microservice architecture including service registry, API gateway, core controller, file service, and web frontend.

## ğŸ—ï¸ æ¶æ„è¯´æ˜ / Architecture

<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1606.46484375 1463.864013671875" style="max-width: 1606.46484375px;" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1763123828084"><style>#mermaid-1763123828084{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-1763123828084 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-1763123828084 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-1763123828084 .error-icon{fill:#552222;}#mermaid-1763123828084 .error-text{fill:#552222;stroke:#552222;}#mermaid-1763123828084 .edge-thickness-normal{stroke-width:1px;}#mermaid-1763123828084 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1763123828084 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1763123828084 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-1763123828084 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1763123828084 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1763123828084 .marker{fill:#333333;stroke:#333333;}#mermaid-1763123828084 .marker.cross{stroke:#333333;}#mermaid-1763123828084 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1763123828084 p{margin:0;}#mermaid-1763123828084 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1763123828084 .cluster-label text{fill:#333;}#mermaid-1763123828084 .cluster-label span{color:#333;}#mermaid-1763123828084 .cluster-label span p{background-color:transparent;}#mermaid-1763123828084 .label text,#mermaid-1763123828084 span{fill:#333;color:#333;}#mermaid-1763123828084 .node rect,#mermaid-1763123828084 .node circle,#mermaid-1763123828084 .node ellipse,#mermaid-1763123828084 .node polygon,#mermaid-1763123828084 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1763123828084 .rough-node .label text,#mermaid-1763123828084 .node .label text,#mermaid-1763123828084 .image-shape .label,#mermaid-1763123828084 .icon-shape .label{text-anchor:middle;}#mermaid-1763123828084 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-1763123828084 .rough-node .label,#mermaid-1763123828084 .node .label,#mermaid-1763123828084 .image-shape .label,#mermaid-1763123828084 .icon-shape .label{text-align:center;}#mermaid-1763123828084 .node.clickable{cursor:pointer;}#mermaid-1763123828084 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-1763123828084 .arrowheadPath{fill:#333333;}#mermaid-1763123828084 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1763123828084 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1763123828084 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-1763123828084 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-1763123828084 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-1763123828084 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-1763123828084 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1763123828084 .cluster text{fill:#333;}#mermaid-1763123828084 .cluster span{color:#333;}#mermaid-1763123828084 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1763123828084 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-1763123828084 rect.text{fill:none;stroke-width:0;}#mermaid-1763123828084 .icon-shape,#mermaid-1763123828084 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-1763123828084 .icon-shape p,#mermaid-1763123828084 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-1763123828084 .icon-shape rect,#mermaid-1763123828084 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-1763123828084 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-1763123828084 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-1763123828084 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1763123828084_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1763123828084_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1763123828084_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1763123828084_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-1763123828084_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-1763123828084_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="subGraph7" class="cluster"><rect height="152" width="764.125" y="258" x="834.33984375" style=""></rect><g transform="translate(1184.42578125, 258)" class="cluster-label"><foreignObject height="24" width="63.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>USB è®¾å¤‡</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph6" class="cluster"><rect height="162.86397552490234" width="722.46875" y="1293" x="113.5078125" style=""></rect><g transform="translate(406.71875, 1293)" class="cluster-label"><foreignObject height="24" width="136.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>æ•°æ®å­˜å‚¨ / Storage</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph5" class="cluster"><rect height="961" width="806.33984375" y="258" x="8" style=""></rect><g transform="translate(311.169921875, 258)" class="cluster-label"><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Kubernetes é›†ç¾¤ / K8s Cluster</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="152" width="1340.5" y="8" x="220.5" style=""></rect><g transform="translate(835.859375, 8)" class="cluster-label"><foreignObject height="24" width="109.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>å¤–éƒ¨ / External</p></span></div></foreignObject></g></g><g data-look="classic" id="ä¸šåŠ¡å±‚" class="cluster"><rect height="128" width="586.5546875" y="864" x="167.78515625" style=""></rect><g transform="translate(437.0625, 864)" class="cluster-label"><foreignObject height="24" width="48"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ä¸šåŠ¡å±‚</p></span></div></foreignObject></g></g><g data-look="classic" id="æ³¨å†Œä¸­å¿ƒ" class="cluster"><rect height="128" width="350.61328125" y="1066" x="28" style=""></rect><g transform="translate(171.306640625, 1066)" class="cluster-label"><foreignObject height="24" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>æ³¨å†Œä¸­å¿ƒ</p></span></div></foreignObject></g></g><g data-look="classic" id="ç½‘å…³å±‚" class="cluster"><rect height="128" width="718.5546875" y="662" x="75.78515625" style=""></rect><g transform="translate(411.0625, 662)" class="cluster-label"><foreignObject height="24" width="48"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ç½‘å…³å±‚</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="128" width="248.609375" y="460" x="291.1953125" style=""></rect><g transform="translate(389.8203125, 460)" class="cluster-label"><foreignObject height="24" width="51.359375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Web å±‚</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_USER_INGRESS_0" d="M325.5,123L325.5,129.167C325.5,135.333,325.5,147.667,325.5,162C325.5,176.333,325.5,192.667,325.5,209C325.5,225.333,325.5,241.667,333.786,253.717C342.073,265.767,358.645,273.535,366.931,277.419L375.218,281.302"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_AGENT1_INGRESS_0" d="M626.73,112.812L599.301,120.676C571.872,128.541,517.014,144.271,489.585,160.302C462.156,176.333,462.156,192.667,462.156,209C462.156,225.333,462.156,241.667,463.342,253.368C464.528,265.069,466.899,272.138,468.085,275.673L469.271,279.208"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_AGENT2_INGRESS_0" d="M1233.191,128.473L1221.319,133.727C1209.447,138.982,1185.702,149.491,1173.829,162.912C1161.957,176.333,1161.957,192.667,1087.227,209C1012.496,225.333,863.035,241.667,770.422,255.849C677.809,270.031,642.044,282.063,624.162,288.078L606.28,294.094"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_INGRESS_WEB_0" d="M439.234,385L435.279,389.167C431.323,393.333,423.411,401.667,419.456,410C415.5,418.333,415.5,426.667,415.5,435C415.5,443.333,415.5,451.667,415.5,459.333C415.5,467,415.5,474,415.5,477.5L415.5,481"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_INGRESS_GATEWAY_0" d="M602.488,375.489L618.408,381.241C634.328,386.993,666.168,398.496,682.088,408.415C698.008,418.333,698.008,426.667,698.008,435C698.008,443.333,698.008,451.667,698.008,466.5C698.008,481.333,698.008,502.667,698.008,524C698.008,545.333,698.008,566.667,698.008,583.5C698.008,600.333,698.008,612.667,698.008,625C698.008,637.333,698.008,649.667,681.249,660.932C664.49,672.198,630.973,682.395,614.214,687.494L597.456,692.593"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_WEB_GATEWAY_0" d="M415.5,563L415.5,567.167C415.5,571.333,415.5,579.667,415.5,590C415.5,600.333,415.5,612.667,415.5,625C415.5,637.333,415.5,649.667,419.699,659.558C423.897,669.449,432.295,676.897,436.493,680.621L440.692,684.346"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GATEWAY_EUREKA_0" d="M381.676,744.239L337.361,751.866C293.046,759.493,204.415,774.746,160.1,788.54C115.785,802.333,115.785,814.667,115.785,827C115.785,839.333,115.785,851.667,115.785,868.5C115.785,885.333,115.785,906.667,115.785,928C115.785,949.333,115.785,970.667,115.785,987.5C115.785,1004.333,115.785,1016.667,115.785,1029C115.785,1041.333,115.785,1053.667,123.475,1063.7C131.164,1073.734,146.543,1081.469,154.232,1085.336L161.922,1089.203"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_CONTROLLER_EUREKA_0" d="M250.481,967L243.662,971.167C236.844,975.333,223.207,983.667,216.389,994C209.57,1004.333,209.57,1016.667,209.57,1029C209.57,1041.333,209.57,1053.667,211.441,1063.409C213.311,1073.152,217.051,1080.304,218.922,1083.88L220.792,1087.456"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FOLDER_EUREKA_0" d="M524.012,965.253L512.325,969.711C500.638,974.169,477.264,983.084,465.577,993.709C453.891,1004.333,453.891,1016.667,428.38,1029C402.87,1041.333,351.849,1053.667,323.023,1063.505C294.198,1073.344,287.567,1080.687,284.252,1084.359L280.936,1088.031"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GATEWAY_CONTROLLER_0" d="M382.016,765L370.73,769.167C359.444,773.333,336.873,781.667,325.587,792C314.301,802.333,314.301,814.667,314.301,827C314.301,839.333,314.301,851.667,314.301,861.333C314.301,871,314.301,878,314.301,881.5L314.301,885"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GATEWAY_FOLDER_0" d="M569.323,765L578.048,769.167C586.774,773.333,604.225,781.667,612.95,792C621.676,802.333,621.676,814.667,621.676,827C621.676,839.333,621.676,851.667,621.676,861.333C621.676,871,621.676,878,621.676,881.5L621.676,885"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_CONTROLLER_MYSQL_0" d="M314.301,967L314.301,971.167C314.301,975.333,314.301,983.667,314.301,994C314.301,1004.333,314.301,1016.667,333.932,1029C353.563,1041.333,392.824,1053.667,412.455,1070.5C432.086,1087.333,432.086,1108.667,432.086,1130C432.086,1151.333,432.086,1172.667,432.086,1187.5C432.086,1202.333,432.086,1210.667,432.086,1221C432.086,1231.333,432.086,1243.667,432.086,1256C432.086,1268.333,432.086,1280.667,431.389,1290.431C430.691,1300.195,429.297,1307.39,428.6,1310.987L427.903,1314.584"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FOLDER_MYSQL_0" d="M621.676,967L621.676,971.167C621.676,975.333,621.676,983.667,621.676,994C621.676,1004.333,621.676,1016.667,621.676,1029C621.676,1041.333,621.676,1053.667,621.676,1070.5C621.676,1087.333,621.676,1108.667,621.676,1130C621.676,1151.333,621.676,1172.667,621.676,1187.5C621.676,1202.333,621.676,1210.667,621.676,1221C621.676,1231.333,621.676,1243.667,621.676,1256C621.676,1268.333,621.676,1280.667,593.496,1297.989C565.317,1315.312,508.957,1337.624,480.778,1348.78L452.598,1359.936"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FOLDER_NFS_0" d="M675.503,967L681.254,971.167C687.005,975.333,698.506,983.667,704.257,994C710.008,1004.333,710.008,1016.667,710.008,1029C710.008,1041.333,710.008,1053.667,710.008,1070.5C710.008,1087.333,710.008,1108.667,710.008,1130C710.008,1151.333,710.008,1172.667,710.008,1187.5C710.008,1202.333,710.008,1210.667,710.008,1221C710.008,1231.333,710.008,1243.667,710.008,1256C710.008,1268.333,710.008,1280.667,699.787,1293.54C689.567,1306.413,669.125,1319.825,658.905,1326.531L648.684,1333.238"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_CONTROLLER_NFS_0" d="M377.426,967L384.17,971.167C390.914,975.333,404.402,983.667,411.146,994C417.891,1004.333,417.891,1016.667,440.855,1029C463.819,1041.333,509.747,1053.667,532.712,1070.5C555.676,1087.333,555.676,1108.667,555.676,1130C555.676,1151.333,555.676,1172.667,555.676,1187.5C555.676,1202.333,555.676,1210.667,555.676,1221C555.676,1231.333,555.676,1243.667,555.676,1256C555.676,1268.333,555.676,1280.667,558.069,1293.28C560.462,1305.894,565.248,1318.788,567.641,1325.235L570.034,1331.682"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GATEWAY_NFS_0" d="M593.629,749.658L623.747,756.382C653.866,763.105,714.103,776.553,744.221,789.443C774.34,802.333,774.34,814.667,774.34,827C774.34,839.333,774.34,851.667,774.34,868.5C774.34,885.333,774.34,906.667,774.34,928C774.34,949.333,774.34,970.667,774.34,987.5C774.34,1004.333,774.34,1016.667,774.34,1029C774.34,1041.333,774.34,1053.667,774.34,1070.5C774.34,1087.333,774.34,1108.667,774.34,1130C774.34,1151.333,774.34,1172.667,774.34,1187.5C774.34,1202.333,774.34,1210.667,774.34,1221C774.34,1231.333,774.34,1243.667,774.34,1256C774.34,1268.333,774.34,1280.667,754.924,1295.224C735.509,1309.78,696.678,1326.561,677.263,1334.951L657.848,1343.341"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_EUREKA_NFS_0" d="M243.043,1169L243.043,1173.167C243.043,1177.333,243.043,1185.667,243.043,1194C243.043,1202.333,243.043,1210.667,243.043,1221C243.043,1231.333,243.043,1243.667,243.043,1256C243.043,1268.333,243.043,1280.667,288.159,1297.549C333.274,1314.431,423.506,1335.861,468.621,1346.577L513.737,1357.292"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_AGENT1_ANDROID1_0" d="M827.699,122.58L843.943,128.816C860.188,135.053,892.676,147.527,908.92,161.93C925.164,176.333,925.164,192.667,928.544,209C931.923,225.333,938.682,241.667,942.062,257.333C945.441,273,945.441,288,945.441,295.5L945.441,303"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_AGENT1_ANDROID2_0" d="M827.699,104.686L872.482,113.905C917.264,123.124,1006.829,141.562,1051.612,158.948C1096.395,176.333,1096.395,192.667,1104.936,209C1113.478,225.333,1130.561,241.667,1139.103,257.333C1147.645,273,1147.645,288,1147.645,295.5L1147.645,303"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_AGENT2_IOS1_0" d="M1333.676,135L1333.676,139.167C1333.676,143.333,1333.676,151.667,1333.676,164C1333.676,176.333,1333.676,192.667,1333.676,209C1333.676,225.333,1333.676,241.667,1333.676,257.333C1333.676,273,1333.676,288,1333.676,295.5L1333.676,303"></path><path marker-end="url(#mermaid-1763123828084_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_AGENT2_IOS2_0" d="M1434.16,128.96L1445.723,134.133C1457.285,139.306,1480.41,149.653,1491.973,162.993C1503.535,176.333,1503.535,192.667,1503.535,209C1503.535,225.333,1503.535,241.667,1503.535,257.333C1503.535,273,1503.535,288,1503.535,295.5L1503.535,303"></path></g><g class="edgeLabels"><g transform="translate(325.5, 209)" class="edgeLabel"><g transform="translate(-33.6796875, -24)" class="label"><foreignObject height="48" width="67.359375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>HTTPS<br>è®¿é—® Web</p></span></div></foreignObject></g></g><g transform="translate(462.15625, 209)" class="edgeLabel"><g transform="translate(-32, -24)" class="label"><foreignObject height="48" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>WSS<br>æ³¨å†Œè¿æ¥</p></span></div></foreignObject></g></g><g transform="translate(1161.95703125, 209)" class="edgeLabel"><g transform="translate(-32, -24)" class="label"><foreignObject height="48" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>WSS<br>æ³¨å†Œè¿æ¥</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(415.5, 625)" class="edgeLabel"><g transform="translate(-29.8203125, -12)" class="label"><foreignObject height="24" width="59.640625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>API è¯·æ±‚</p></span></div></foreignObject></g></g><g transform="translate(115.78515625, 928)" class="edgeLabel"><g transform="translate(-32, -12)" class="label"><foreignObject height="24" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æœåŠ¡å‘ç°</p></span></div></foreignObject></g></g><g transform="translate(209.5703125, 1029)" class="edgeLabel"><g transform="translate(-16, -12)" class="label"><foreignObject height="24" width="32"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ³¨å†Œ</p></span></div></foreignObject></g></g><g transform="translate(453.890625, 1029)" class="edgeLabel"><g transform="translate(-16, -12)" class="label"><foreignObject height="24" width="32"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ³¨å†Œ</p></span></div></foreignObject></g></g><g transform="translate(314.30078125, 827)" class="edgeLabel"><g transform="translate(-16, -12)" class="label"><foreignObject height="24" width="32"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>è·¯ç”±</p></span></div></foreignObject></g></g><g transform="translate(621.67578125, 827)" class="edgeLabel"><g transform="translate(-16, -12)" class="label"><foreignObject height="24" width="32"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>è·¯ç”±</p></span></div></foreignObject></g></g><g transform="translate(432.0859375, 1130)" class="edgeLabel"><g transform="translate(-24, -12)" class="label"><foreignObject height="24" width="48"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ•°æ®åº“</p></span></div></foreignObject></g></g><g transform="translate(621.67578125, 1130)" class="edgeLabel"><g transform="translate(-24, -12)" class="label"><foreignObject height="24" width="48"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ•°æ®åº“</p></span></div></foreignObject></g></g><g transform="translate(710.0078125, 1130)" class="edgeLabel"><g transform="translate(-32, -12)" class="label"><foreignObject height="24" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ–‡ä»¶å­˜å‚¨</p></span></div></foreignObject></g></g><g transform="translate(555.67578125, 1130)" class="edgeLabel"><g transform="translate(-16, -12)" class="label"><foreignObject height="24" width="32"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ—¥å¿—</p></span></div></foreignObject></g></g><g transform="translate(774.33984375, 1029)" class="edgeLabel"><g transform="translate(-16, -12)" class="label"><foreignObject height="24" width="32"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ—¥å¿—</p></span></div></foreignObject></g></g><g transform="translate(243.04296875, 1256)" class="edgeLabel"><g transform="translate(-16, -12)" class="label"><foreignObject height="24" width="32"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>æ—¥å¿—</p></span></div></foreignObject></g></g><g transform="translate(925.1640625, 209)" class="edgeLabel"><g transform="translate(-13.5625, -24)" class="label"><foreignObject height="48" width="27.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>USB<br>adb</p></span></div></foreignObject></g></g><g transform="translate(1096.39453125, 209)" class="edgeLabel"><g transform="translate(-13.5625, -24)" class="label"><foreignObject height="48" width="27.125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>USB<br>adb</p></span></div></foreignObject></g></g><g transform="translate(1333.67578125, 209)" class="edgeLabel"><g transform="translate(-31.546875, -24)" class="label"><foreignObject height="48" width="63.09375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>USB<br>usbmuxd</p></span></div></foreignObject></g></g><g transform="translate(1503.53515625, 209)" class="edgeLabel"><g transform="translate(-31.546875, -24)" class="label"><foreignObject height="48" width="63.09375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>USB<br>usbmuxd</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(325.5, 84)" id="flowchart-USER-0" class="node default"><rect height="78" width="140" y="-39" x="-70" style="fill:#e1f5ff !important" class="basic label-container"></rect><g transform="translate(-40, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="80"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ç”¨æˆ·æµè§ˆå™¨<br>Browser</p></span></div></foreignObject></g></g><g transform="translate(727.21484375, 84)" id="flowchart-AGENT1-1" class="node default"><rect height="102" width="200.96875" y="-51" x="-100.484375" style="fill:#d4e1ff !important" class="basic label-container"></rect><g transform="translate(-70.484375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="140.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sonic-agent<br>ç‰©ç†æœº 1<br>172.16.136.98:7777</p></span></div></foreignObject></g></g><g transform="translate(1333.67578125, 84)" id="flowchart-AGENT2-2" class="node default"><rect height="102" width="200.96875" y="-51" x="-100.484375" style="fill:#d4e1ff !important" class="basic label-container"></rect><g transform="translate(-70.484375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="140.96875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sonic-agent<br>ç‰©ç†æœº 2<br>172.16.136.99:7777</p></span></div></foreignObject></g></g><g transform="translate(487.65234375, 334)" id="flowchart-INGRESS-3" class="node default"><rect height="102" width="229.671875" y="-51" x="-114.8359375" style="fill:#ffe1e1 !important" class="basic label-container"></rect><g transform="translate(-84.8359375, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="169.671875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Ingress<br>sonic.example.com:443<br>HTTPS/WSS å…¥å£</p></span></div></foreignObject></g></g><g transform="translate(415.5, 524)" id="flowchart-WEB-4" class="node default"><rect height="78" width="178.609375" y="-39" x="-89.3046875" style="fill:#fff4e1 !important" class="basic label-container"></rect><g transform="translate(-59.3046875, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="118.609375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sonic-client-web<br>:80</p></span></div></foreignObject></g></g><g transform="translate(487.65234375, 726)" id="flowchart-GATEWAY-5" class="node default"><rect height="78" width="211.953125" y="-39" x="-105.9765625" style="fill:#ffd4d4 !important" class="basic label-container"></rect><g transform="translate(-75.9765625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="151.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sonic-server-gateway<br>:3000</p></span></div></foreignObject></g></g><g transform="translate(243.04296875, 1130)" id="flowchart-EUREKA-6" class="node default"><rect height="78" width="201.140625" y="-39" x="-100.5703125" style="fill:#d4ffd4 !important" class="basic label-container"></rect><g transform="translate(-70.5703125, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="141.140625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sonic-server-eureka<br>:8761</p></span></div></foreignObject></g></g><g transform="translate(314.30078125, 928)" id="flowchart-CONTROLLER-7" class="node default"><rect height="78" width="223.03125" y="-39" x="-111.515625" style="fill:#ffe1f0 !important" class="basic label-container"></rect><g transform="translate(-81.515625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="163.03125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sonic-server-controller<br>:8082</p></span></div></foreignObject></g></g><g transform="translate(621.67578125, 928)" id="flowchart-FOLDER-8" class="node default"><rect height="78" width="195.328125" y="-39" x="-97.6640625" style="fill:#f0e1ff !important" class="basic label-container"></rect><g transform="translate(-67.6640625, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="135.328125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>sonic-server-folder<br>:8083</p></span></div></foreignObject></g></g><g transform="translate(415.98046875, 1374.4319877624512)" id="flowchart-MYSQL-9" class="node default"><path transform="translate(-32.8984375, -56.431987552207026)" style="fill:#f0f0f0 !important" class="basic label-container" d="M0,8.621325034804684 a32.8984375,8.621325034804684 0,0,0 65.796875,0 a32.8984375,8.621325034804684 0,0,0 -65.796875,0 l0,95.62132503480468 a32.8984375,8.621325034804684 0,0,0 65.796875,0 l0,-95.62132503480468"></path><g transform="translate(-25.3984375, -26)" style="" class="label"><rect></rect><foreignObject height="72" width="50.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>MySQL<br>Cluster<br>:3306</p></span></div></foreignObject></g></g><g transform="translate(585.90234375, 1374.4319877624512)" id="flowchart-NFS-10" class="node default"><rect height="78" width="136.546875" y="-39" x="-68.2734375" style="fill:#f5f5f5 !important" class="basic label-container"></rect><g transform="translate(-38.2734375, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="76.546875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>NFS Server<br>æ–‡ä»¶å­˜å‚¨</p></span></div></foreignObject></g></g><g transform="translate(945.44140625, 334)" id="flowchart-ANDROID1-11" class="node default"><rect height="54" width="152.203125" y="-27" x="-76.1015625" style="fill:#e8f5e9 !important" class="basic label-container"></rect><g transform="translate(-46.1015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="92.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Android è®¾å¤‡</p></span></div></foreignObject></g></g><g transform="translate(1147.64453125, 334)" id="flowchart-ANDROID2-12" class="node default"><rect height="54" width="152.203125" y="-27" x="-76.1015625" style="fill:#e8f5e9 !important" class="basic label-container"></rect><g transform="translate(-46.1015625, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="92.203125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Android è®¾å¤‡</p></span></div></foreignObject></g></g><g transform="translate(1333.67578125, 334)" id="flowchart-IOS1-13" class="node default"><rect height="54" width="119.859375" y="-27" x="-59.9296875" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-29.9296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="59.859375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>iOS è®¾å¤‡</p></span></div></foreignObject></g></g><g transform="translate(1503.53515625, 334)" id="flowchart-IOS2-14" class="node default"><rect height="54" width="119.859375" y="-27" x="-59.9296875" style="fill:#fff3e0 !important" class="basic label-container"></rect><g transform="translate(-29.9296875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="59.859375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>iOS è®¾å¤‡</p></span></div></foreignObject></g></g></g></g></g></svg>


### é€šä¿¡åè®® / Communication

|é€šä¿¡æ–¹å‘|åè®®|ç«¯å£|è¯´æ˜|
|-|-|-|-|
|æµè§ˆå™¨ â†’ Ingress | HTTPS/WSS | 443 | ç”¨æˆ·è®¿é—® |
|Agent â†’ Ingress | WSS | 443 | Agent è¿æ¥ |
|Ingress â†’ Gateway | WS/HTTP | 3000 | å†…éƒ¨é€šä¿¡ |
|Gateway â†’ Controller | WS/HTTP | 8082 | å†…éƒ¨é€šä¿¡ |
|Gateway â†’ Folder | HTTP | 8083 | å†…éƒ¨é€šä¿¡ |
|Controller â†’ MySQL | MySQL | 3306 | æ•°æ®åº“ |
|Agent â†’ è®¾å¤‡ | USB | - | æœ¬åœ° USB |


## ğŸ“¦ éƒ¨ç½²å‰å‡†å¤‡ / Prerequisites

### å¿…éœ€ç»„ä»¶ / Required

- âœ… Kubernetes é›†ç¾¤ (v1.20+)
- âœ… kubectl å‘½ä»¤è¡Œå·¥å…·
- âœ… MySQL æ•°æ®åº“ (5.7+ / 8.0+)
- âœ… NFS å­˜å‚¨æœåŠ¡å™¨ï¼ˆç”¨äºæ—¥å¿—å’Œæ–‡ä»¶å­˜å‚¨ï¼‰
- âœ… Ingress Controller (nginx-ingress æ¨è)

### å¯é€‰ç»„ä»¶ / Optional

- âš ï¸ LDAP/AD æœåŠ¡å™¨ï¼ˆå¦‚æœå¯ç”¨ LDAP è®¤è¯ï¼‰
- âš ï¸ TLS è¯ä¹¦ï¼ˆHTTPS è®¿é—®ï¼‰

### å‡†å¤‡ MySQL æ•°æ®åº“ / Prepare MySQL Database
```sql
-- åˆ›å»ºæ•°æ®åº“ / CREATE DATABASE
CREATE DATABASE IF NOT EXISTS sonic 
    CHARACTER SET utf8mb4 
    COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºç”¨æˆ· / CREATE USER
CREATE USER IF NOT EXISTS 'sonic_client'@'%' IDENTIFIED BY 'your-password';

-- æˆæƒ / GRANT PRIVILEGES
GRANT ALL PRIVILEGES ON sonic.* TO 'sonic_client'@'%';
FLUSH PRIVILEGES;
```

### å‡†å¤‡ NFS ç›®å½• / Prepare NFS Directories
```shell
# åœ¨ NFS æœåŠ¡å™¨ä¸Šåˆ›å»ºç›®å½•
sudo mkdir -p /autoops/data/sonic/{keepFiles,imageFiles,recordFiles,packageFiles}
sudo mkdir -p /autoops/log/sonic

# è®¾ç½®æƒé™
sudo chown -R nobody:nogroup /autoops/data/sonic
sudo chown -R nobody:nogroup /autoops/log/sonic
sudo chmod -R 777 /autoops/data/sonic
sudo chmod -R 777 /autoops/log/sonic

# é…ç½® NFS å¯¼å‡º
sudo nano /etc/exports

# æ·»åŠ ï¼š
/autoops/data/sonic *(rw,sync,no_subtree_check,no_root_squash)
/autoops/log/sonic *(rw,sync,no_subtree_check,no_root_squash)

# é‡æ–°åŠ è½½
sudo exportfs -ra
```

## âš™ï¸ é…ç½®è¯´æ˜ / Configuration
å¿…é¡»ä¿®æ”¹çš„é…ç½®é¡¹ / Required Configuration
åœ¨éƒ¨ç½²å‰ï¼Œç¼–è¾‘ sonic-all-in-one.yaml ä¸­çš„ ConfigMapï¼Œä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š

### åŸºç¡€é…ç½® / Basic Settings
```yaml
  # æœåŠ¡å™¨è®¿é—®åœ°å€ï¼ˆIngress åŸŸåï¼‰
  server_host: sonic.example.com        # â† æ”¹æˆä½ çš„åŸŸå

  # å¯†é’¥ï¼ˆç”¨äº JWT Token åŠ å¯†ï¼‰
  secret_key: xxxxx                     # â† æ”¹æˆéšæœºå­—ç¬¦ä¸²ï¼ˆ32ä½ï¼‰
  
  # ç®¡ç†å‘˜è´¦å·
  permission_super_admin: sonic         # â† æ”¹æˆä½ çš„ç®¡ç†å‘˜ç”¨æˆ·å

```
### MySQL é…ç½® / MySQL Settings
```yaml
  mysql_host: mysql-cluster-01.example.com  # â† ä½ çš„ MySQL åœ°å€
  mysql_port: "3306"
  mysql_database: sonic
  mysql_username: sonic_client          # â† ä½ çš„æ•°æ®åº“ç”¨æˆ·å
  mysql_password: xxxxx                 # â† ä½ çš„æ•°æ®åº“å¯†ç 
```

### NFS é…ç½® / NFS Settings
```yaml
# åœ¨å„ Deployment çš„ volumes éƒ¨åˆ†
volumes:
  - name: sonic-log-store
    nfs:
      path: /autoops/log/sonic
      server: nfs-cluster-01.example.com  # â† ä½ çš„ NFS æœåŠ¡å™¨åœ°å€
```

### Agent é…ç½® / Agent Settings

#### config/application-sonic-agent.yml

```yaml
sonic:
  agent:
    # Replace with
    ws-scheme: wss
    # Replace with ipv4 of the agent machine | æ›¿æ¢ä¸ºéƒ¨ç½²Agentæœºå™¨çš„ipv4
    host: sonic-agent1.example.com
    # Replace with the port of the agent service, which can be changed by yourself | æ›¿æ¢ä¸ºAgentæœåŠ¡çš„ç«¯å£ï¼Œå¯ä»¥è‡ªè¡Œæ›´æ”¹
    port: 7777
    #
    service-port: 443
    # Replace with the key of agent generated by the new front-end | æ›¿æ¢ä¸ºå‰ç«¯æ–°å¢Agentç”Ÿæˆçš„key
    key: c513a736-9eff-452e-8820-e6353e51f1bf
  server:
    #
    scheme: https
    # Change to SONIC_SERVER_HOST of server | æ”¹æˆserverçš„SONIC_SERVER_HOST
    host: sonic.example.com
    # Change to SONIC_SERVER_PORT of server | æ”¹æˆserverçš„SONIC_SERVER_PORT
    port: 443

# The following will be migrated to the server configuration in the future | ä»¥ä¸‹æœªæ¥ä¼šè¿ç§»åˆ°serveré…ç½®
modules:
  ios:
    # Replace with the bundleId of wda. If there is no. xcrunner suffix, it will be automatically completed. | æ›¿æ¢ä¸ºwdaçš„bundleIdï¼Œå¦‚æœæ²¡æœ‰.xctrunneråç¼€ä¼šè‡ªåŠ¨è¡¥å…¨
    wda-bundle-id: com.sonic.WebDriverAgentRunner
    # (mac only) Replace with the xcode project path of wda. | æ›¿æ¢ä¸ºwdaçš„xcode projectç›®å½•
    wda-xcode-project-path: WebdriverAgent/WebDriverAgent.xcodeproj
```

#### /etc/systemd/system/sonic-agent.service
```ini
[Unit]
Description=Sonic Agent Service
After=network-online.target
Wants=network-online.target

[Service]
Type=simple

# Use root (USB permission reuqired)
User=root
Group=root
WorkingDirectory=/opt/sonic-agent
ExecStart=/usr/bin/java -Dfile.encoding=utf-8 -Xms512m -Xmx1024m -jar sonic-agent-linux-x86_64.jar

Restart=on-failure
RestartSec=10
StartLimitInterval=300
StartLimitBurst=5

LimitNOFILE=65536

TimeoutStartSec=90

[Install]
WantedBy=multi-user.target
```

## å¯é€‰é…ç½® / Optional Configuration
### LDAP é…ç½® / LDAP Settings
```yaml
  # å¯ç”¨ LDAP è®¤è¯
  sonic_ldap_enable: "true"             # â† æ”¹ä¸º true å¯ç”¨
  
  # LDAP æœåŠ¡å™¨
  spring_ldap_url: ldap://172.16.0.1    #:3268
  spring_ldap_base: DC=example,DC=com
  spring_ldap_username: auth_ldap@example.com
  spring_ldap_password: xxxxx
  
  # LDAP ç”¨æˆ·æœç´¢
  sonic_ldap_user_base_dn: ""           # ç•™ç©ºä» base æœç´¢
  sonic_ldap_object_class: user         # AD ç”¨ userï¼ŒOpenLDAP ç”¨ person
  sonic_ldap_user_id: sAMAccountName    # AD ç”¨æˆ· ID å±æ€§
```

### åŠŸèƒ½å¼€å…³ / Feature Flags
```yaml
  register_enable: "true"          # æ˜¯å¦å…è®¸ç”¨æˆ·æ³¨å†Œ
  normal_user_enable: "true"       # æ˜¯å¦å¯ç”¨æ™®é€šç”¨æˆ·
  permission_enable: "true"        # æ˜¯å¦å¯ç”¨æƒé™ç³»ç»Ÿ
```